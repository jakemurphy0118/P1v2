#include "P1HistoMessenger.hh"
#include "P1Histo.hh"

#include "G4UIdirectory.hh"
#include "G4UIcmdWithAString.hh"
#include "G4UIcmdWithADoubleAndUnit.hh"

P1HistoMessenger::P1HistoMessenger(P1Histo* histo)
  : fHisto(histo)
{
  fP1Dir = new G4UIdirectory("/P1/");
  fP1Dir->SetGuidance("UI commands for P1");

  fHistoDir = new G4UIdirectory("/P1/histo/");
  fHistoDir->SetGuidance("Histogram initialization");

  fHistoTitleCmd = new G4UIcmdWithAString("/P1/histo/setHistoTitle", this);
  fHistoTitleCmd->SetGuidance("Provide a title for the histogram");
  fHistoTitleCmd->SetParameterName("title", false);
  fHistoTitleCmd->AvailableForStates(G4State_PreInit, G4State_Idle);

  fLowerBoundCmd = new G4UIcmdWithADoubleAndUnit("/P1/histo/setLowerBound", this);
  fLowerBoundCmd->SetGuidance("Set the lower bound of the histogram");
  fLowerBoundCmd->SetParameterName("lBound", false);
  fLowerBoundCmd->SetRange("lBound>=0.");
  fLowerBoundCmd->SetUnitCategory("Distance");
  fLowerBoundCmd->AvailableForStates(G4State_PreInit, G4State_Idle);

  fUpperBoundCmd = new G4UIcmdWithADoubleAndUnit("/S1/histo/setUpperBound",this);
  fUpperBoundCmd->SetGuidance("Set the upper bound of the histogram");
  fUpperBoundCmd->SetParameterName("uBound", false);
  fUpperBoundCmd->SetUnitCategory("Energy");
  fUpperBoundCmd->AvailableForStates(G4State_PreInit, G4State_Idle);
}

S1HistoMessenger::~S1HistoMessenger()
{
  delete fS1Dir;
  delete fHistoDir;
  delete fHistoTitleCmd;
  delete fLowerBoundCmd;
  delete fUpperBoundCmd;
}

void S1HistoMessenger::SetNewValue(G4UIcommand* command, G4String newValue)
{
  if ( command == fHistoTitleCmd )
    {
      fHisto->setHistoTitle(newValue);
    }
  if ( command == fLowerBoundCmd )
    {
      fHisto->setLowerBound(fLowerBoundCmd->GetNewDoubleValue(newValue));
    }
  if (command == fUpperBoundCmd)
    {
      fHisto->setUpperBound(fUpperBoundCmd->GetNewDoubleValue(newValue));
    }
}
